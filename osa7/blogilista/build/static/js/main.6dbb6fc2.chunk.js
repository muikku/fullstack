(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{193:function(e,t,n){e.exports=n(358)},356:function(e,t,n){},358:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),u=n(51),l=n.n(u),o=n(75),c=n(76),i=n(83),s=n(77),m=n(84),p=n(23),f=n(375),d=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];switch((arguments.length>1?arguments[1]:void 0).type){case"TOGGLE":return!e;default:return e}},g=n(374),h=function(e,t){var n=e.message;return null===n?null:a.a.createElement("div",{key:n.toString()},t?a.a.createElement(g.a,{positive:!0},a.a.createElement(g.a.Header,null,n)):a.a.createElement(g.a,{negative:!0},a.a.createElement(g.a.Header,null,n)))},v=function(e,t,n){return function(r){var a=h({message:e},t);r({type:"NOTIFY",notification:a}),setTimeout(function(){r({type:"HIDE",key:a.key})},n)}},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NOTIFY":return e.map(function(e){return e.key}).includes(t.notification.key)?e:e.concat(t.notification);case"HIDE":return e.filter(function(e){return e.key!==t.key});default:return e}},b=n(8),y=n.n(b),w=n(16),k=n(162),O=n(27),x=n.n(O),B=null,j={getAll:function(){var e=Object(w.a)(y.a.mark(function e(){var t;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.get("/api/blogs");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(w.a)(y.a.mark(function e(t){var n,r;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:B}},e.next=3,x.a.post("/api/blogs",t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(w.a)(y.a.mark(function e(t,n){var r;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.put("".concat("/api/blogs","/").concat(t),n);case 2:return r=e.sent,console.log(r.data),e.abrupt("return",r.data);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),setToken:function(e){B="bearer ".concat(e)},remove:function(){var e=Object(w.a)(y.a.mark(function e(t){var n,r;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:B}},e.next=3,x.a.delete("".concat("/api/blogs","/").concat(t),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getUserBlogs:function(){var e=Object(w.a)(y.a.mark(function e(){var t,n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={headers:{Authorization:B}},e.next=3,x.a.get("/api/user",t);case 3:return n=e.sent,e.abrupt("return",n.data);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),commentBlog:function(){var e=Object(w.a)(y.a.mark(function e(t){var n,r;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:B}},e.next=3,x.a.post("/api/blogs/".concat(t.blogId,"/comments"),t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getComments:function(){var e=Object(w.a)(y.a.mark(function e(){var t;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.get("/api/blogs/all/comments");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},T=function(e){return function(){var t=Object(w.a)(y.a.mark(function t(n){var r,a;return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=Object(k.a)({},e,{likes:e.likes+1}),t.next=3,j.update(r._id,r);case 3:a=e._id,n({type:"LIKE_BLOG",id:a});case 5:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},I=function(e){return function(){var t=Object(w.a)(y.a.mark(function t(n){return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.remove(e);case 2:n({type:"DELETE_BLOG",id:e});case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CREATE_BLOG":case"INIT_BLOGS":return t.data;case"LIKE_BLOG":var n=t.id,r=e.find(function(e){return e._id===n});return e.filter(function(e){return e._id!==n}).concat(Object(k.a)({},r,{likes:r.likes+1}));case"DELETE_BLOG":return e.filter(function(e){return e._id!==t.id});default:return e}},S=n(325),N=n(376),L=n(373),U=function(e){return e?"title":"most likes"},C=function(e){return e?"most likes":"title"},G=Object(p.b)(function(e){return{showBlogs:(t=e.blogs,n=e.toggle,n?t.sort(function(e,t){return t.likes-e.likes}):t.sort(function(e,t){return e.title.localeCompare(t.title)})),theLabel:U(e.toggle),theshowLabel:C(e.toggle)};var t,n},{likeBlog:T,deleteBlog:I,notify:v,toggle:function(){return function(e){e({type:"TOGGLE"})}}})(function(e){return a.a.createElement("div",null,a.a.createElement("div",null,a.a.createElement(N.a,{onClick:function(){return e.toggle()}},"sort by ",e.theLabel)),a.a.createElement(L.a,null,a.a.createElement(L.a.Body,null,e.showBlogs.map(function(e){return a.a.createElement(L.a.Row,{key:e._id},a.a.createElement(L.a.Cell,null,a.a.createElement(S.a,{key:e._id,to:"/blogs/".concat(e._id)},e.title," by ",e.author)))}))))}),A={getAll:function(){var e=Object(w.a)(y.a.mark(function e(){var t;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},R=function(){return function(){var e=Object(w.a)(y.a.mark(function e(t){var n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.getAll();case 2:n=e.sent,t({type:"GETUSERS",data:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GETUSERS":return t.data;default:return e}},z=n(371),D=n(378),F=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,a=new Array(r),u=0;u<r;u++)a[u]=arguments[u];return(n=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(a)))).state={redir:!1,id:null},n.onSubmit=function(){var e=Object(w.a)(y.a.mark(function e(t){var r,a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),t.persist(),![t.target.blogAuthor.value,t.target.blogTitle.value,t.target.blogUrl.value].includes("")){e.next=6;break}return n.props.notify("all fields must be filled",!1,5e3),e.abrupt("return",null);case 6:try{n.props.createBlog({author:t.target.blogAuthor.value,title:t.target.blogTitle.value,url:t.target.blogUrl.value,likes:0}),n.props.getUsers(),n.props.notify("a new blog ".concat(t.target.blogTitle.value," by ").concat(t.target.blogAuthor.value," added"),!0,5e3),t.target.blogAuthor.value="",t.target.blogTitle.value="",t.target.blogUrl.value="",r=n.props.usersBlogs.reverse(),a=r[0]._id,n.setState({redir:!0,id:a})}catch(u){console.log(u),n.props.notify("could not add blog :(",!1,5e3)}case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){if(this.state.redir){var e="/blogs/".concat(this.state.id);return a.a.createElement(D.a,{to:e})}return a.a.createElement("div",null,a.a.createElement("h2",null,"create new blog"),a.a.createElement(z.a,{onSubmit:this.onSubmit},a.a.createElement(z.a.Field,null,a.a.createElement("label",null,"author "),a.a.createElement("input",{name:"blogAuthor"})),a.a.createElement(z.a.Field,null,a.a.createElement("label",null,"title"),a.a.createElement("input",{name:"blogTitle"})),a.a.createElement(z.a.Field,null,a.a.createElement("label",null,"url"),a.a.createElement("input",{name:"blogUrl"})),a.a.createElement(N.a,{type:"submit"},"create")))}}]),t}(a.a.Component),J=Object(p.b)(function(e){return{user:e.user,usersBlogs:e.userBlogs}},{createBlog:function(e){return function(){var t=Object(w.a)(y.a.mark(function t(n){var r;return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.create(e);case 2:return t.next=4,j.getAll();case 4:r=t.sent,n({type:"CREATE_BLOG",data:r});case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},notify:v,getUsers:R})(F),H=function(){return a.a.createElement("div",null,a.a.createElement(f.a,{menu:{secondary:!0,pointing:!0},panes:[{menuItem:"Blogs",render:function(){return a.a.createElement(f.a.Pane,{attached:!1},a.a.createElement(G,null))}},{menuItem:"Create new",render:function(){return a.a.createElement(f.a.Pane,{attached:!1},a.a.createElement(J,null))}}]}))},W={login:function(){var e=Object(w.a)(y.a.mark(function e(t){var n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},K=function(e,t){return function(){var n=Object(w.a)(y.a.mark(function n(r){var a;return y.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,W.login({username:e,password:t});case 3:return a=n.sent,window.localStorage.setItem("loggedBlogUser",JSON.stringify(a)),j.setToken(a.token),r({type:"LOGIN",data:a}),n.abrupt("return",!0);case 10:return n.prev=10,n.t0=n.catch(0),console.log(n.t0),n.abrupt("return",null);case 14:case"end":return n.stop()}},n,this,[[0,10]])}));return function(e){return n.apply(this,arguments)}}()},P=function(){return function(){var e=Object(w.a)(y.a.mark(function e(t){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:j.setToken(null),window.localStorage.removeItem("loggedBlogUser"),t({type:"LOGOUT"});case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){var e=window.localStorage.getItem("loggedBlogUser");if(e){var t=JSON.parse(e);return j.setToken(t.token),t}return null}(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return t.data;case"LOGOUT":return null;case"GET_USER":default:return e}},q=Object(p.b)(function(e){return{user:e.user}},{login:K,notify:v})(function(e){var t=function(){var t=Object(w.a)(y.a.mark(function t(n){return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),n.persist(),![n.target.username.value,n.target.password.value].includes("")){t.next=6;break}return e.notify("nothing to login",!1,5e3),t.abrupt("return",null);case 6:e.login(n.target.username.value,n.target.password.value)?(e.notify("welcome ".concat(n.target.username.value),!0,5e3),n.target.username.value="",n.target.password.value=""):e.notify("login failed, wrong username and/or password",!1,5e3);case 8:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}();return a.a.createElement("div",null,e.user?a.a.createElement(D.a,{to:"/blogs"}):a.a.createElement("div",{className:"LoginForm"},a.a.createElement("h2",null,"sign in"),a.a.createElement(z.a,{onSubmit:t},a.a.createElement(z.a.Field,null,a.a.createElement("label",null,"username"),a.a.createElement("input",{name:"username"})),a.a.createElement(z.a.Field,null,a.a.createElement("label",null,"password"),a.a.createElement("input",{type:"password",name:"password"})),a.a.createElement(N.a,{type:"submit"},"sign in"))))}),Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INITUSERBLOGS":return t.userBlogs;case"LOGOUT":return[];default:return e}},V=n(377),X=n(361),Z=function(e){var t=e.users.map(function(e){return{name:e.name,path:"/users/".concat(e._id),blogs:e.blogs.length,_id:e._id}});return a.a.createElement("div",{className:"ui raised segments"},a.a.createElement("div",{className:"ui horizontal segments"},a.a.createElement("div",{className:"ui segment bottom attached"},"users"),a.a.createElement("div",{className:"ui segment bottom attached"},"blogs added")),t.map(function(e){return a.a.createElement("div",{key:e._id,className:"ui horizontal top attached segments"},a.a.createElement("div",{className:"ui segment top attached"},a.a.createElement(S.a,{to:e.path},e.name)),a.a.createElement("div",{className:"ui segment top attached"},e.blogs))}))},$=n(362),ee=n(372),te=function(e){var t=e.user;return a.a.createElement("div",null,t?a.a.createElement("div",null,a.a.createElement($.a,null,a.a.createElement(ee.a,{header:a.a.createElement("h2",null,t.name),extra:a.a.createElement("div",null,a.a.createElement("h3",null,"Added blogs"),a.a.createElement("ul",null,t.blogs.map(function(e){return a.a.createElement("li",{key:e._id},e.title," by ",e.author)})))}))):null)},ne=function(){return function(){var e=Object(w.a)(y.a.mark(function e(t){var n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.getComments();case 2:n=e.sent,t({type:"INITCOMMENTS",content:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CREATECOMMENT":return e.concat(t.content);case"INITCOMMENTS":return t.content;default:return e}},ae=Object(p.b)(function(e){return{comments:e.comments,blogs:e.blogs,userBlogs:e.userBlogs}},{getComments:ne,createComment:function(e){return function(){var t=Object(w.a)(y.a.mark(function t(n){var r;return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j.commentBlog(e);case 2:r=t.sent,n({type:"CREATECOMMENT",content:r});case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},likeBlog:T,deleteBlog:I,notify:v,getUsers:R})(function(e){var t=e.blog;return a.a.createElement("div",null," ",t&&void 0!==e.userBlogs?a.a.createElement("div",null,a.a.createElement($.a,null,a.a.createElement(ee.a,{header:a.a.createElement("h2",null,t.title),meta:t.author,description:a.a.createElement("div",null,a.a.createElement("p",null,t.url),"added by ",t.user.name?t.user.name:"anonymous"),extra:a.a.createElement("div",null,t.likes," likes "," ")})),a.a.createElement("div",null,a.a.createElement(z.a,{onSubmit:function(n){if(n.preventDefault(),[n.target.message.value].includes(""))return e.notify("comment field was empty",!1,5e3),null;var r={message:n.target.message.value,blogId:t._id};e.createComment(r),e.notify("comment was added to blog ".concat(t.title),!0,5e3),n.target.message.value=""}},a.a.createElement(N.a,{type:"submit"},"add comment"),a.a.createElement(N.a,{onClick:function(n){n.preventDefault(),e.likeBlog(t),e.notify("liked blog ".concat(t.title),!0,5e3)}},"like"),e.userBlogs.map(function(e){return e._id}).includes(t._id)?a.a.createElement(N.a,{onClick:function(n){n.preventDefault(),e.deleteBlog(t._id),e.getUsers(),e.notify("deleted blog ".concat(t.title),!1,5e3),e.history.push("/blogs")}},"delete"):null,a.a.createElement($.a,null,a.a.createElement("p",null,"comments"),a.a.createElement(z.a.Field,null,a.a.createElement("input",{name:"message"})),a.a.createElement("ul",{className:"ui list"},e.comments.filter(function(e){return e.blogId===t._id}).map(function(e){return a.a.createElement("li",{key:e._id},e.message)})))))):null," ")}),ue=n(370),le=n(360),oe=n(379),ce=n(369),ie=Object(p.b)(function(e){return{user:e.user}},{notify:v,logout:P})(function(e){return a.a.createElement("div",null,a.a.createElement(le.a,null,a.a.createElement(le.a.Item,null,a.a.createElement(oe.a,{as:"h1",style:{fontWeight:"bold"}},"blog app")),e.user?a.a.createElement(le.a.Menu,null,a.a.createElement(le.a.Item,{link:!0},a.a.createElement(ce.a,{activeStyle:{fontWeight:"bold"},to:"/blogs"},"blogs")),a.a.createElement(le.a.Item,{link:!0},a.a.createElement(ce.a,{activeStyle:{fontWeight:"bold"},to:"/users"},"users"))):null,a.a.createElement(le.a.Menu,{position:"right"},a.a.createElement(le.a.Item,null,e.user?a.a.createElement(oe.a,{as:"h4"},e.user.name," logged in \xa0",a.a.createElement(N.a,{onClick:function(){return e.logout(),void e.notify("logged out",!0,5e3)}},"logout")):a.a.createElement(ce.a,{to:"/login"},"login")))))}),se=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=window.localStorage.getItem("loggedBlogUser");if(e){var t=JSON.parse(e);j.setToken(t.token),this.props.inituser(t),this.props.initializeUserBlogs()}this.props.initializeBlogs(),this.props.getComments(),this.props.getUsers()}},{key:"render",value:function(){var e=this;return a.a.createElement(ue.a,null,a.a.createElement("div",null,a.a.createElement(V.a,null,a.a.createElement("div",null,a.a.createElement(ie,null),a.a.createElement($.a,{basic:!0},this.props.notifications.map(function(e){return e})),a.a.createElement(X.a,{path:"/login",render:function(e){var t=e.history;return a.a.createElement(q,{history:t})}}),this.props.user?a.a.createElement("div",null,a.a.createElement(X.a,{exact:!0,path:"/",render:function(){return a.a.createElement(D.a,{to:"/blogs"})}}),a.a.createElement(X.a,{exact:!0,path:"/blogs",render:function(){return a.a.createElement(H,null)}}),a.a.createElement(X.a,{exact:!0,path:"/users",render:function(){return a.a.createElement(Z,{users:e.props.users})}}),a.a.createElement(X.a,{exact:!0,path:"/users/:id",render:function(t){var n=t.match;return a.a.createElement(te,{user:e.props.users.find(function(e){return e._id===n.params.id})})}}),a.a.createElement(X.a,{exact:!0,path:"/blogs/:id",render:function(t){var n=t.match,r=t.history;return a.a.createElement(ae,{history:r,blog:e.props.showBlogs.find(function(e){return e._id===n.params.id})})}})):a.a.createElement("div",null,["/","/users","/users/:id","/blogs","/blogs/:id","/blogs/:id/comments"].map(function(t){return a.a.createElement(X.a,{key:t,exact:!0,path:t,render:function(){return e.props.user?null:a.a.createElement(D.a,{to:"/login"})}})}))))))}}]),t}(a.a.Component),me=Object(p.b)(function(e){return{showBlogs:e.blogs,user:e.user,notifications:e.notification,users:e.users,userBlogs:e.userBlogs}},{initializeBlogs:function(){return function(){var e=Object(w.a)(y.a.mark(function e(t){var n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},getComments:ne,initializeUserBlogs:function(){return function(){var e=Object(w.a)(y.a.mark(function e(t){var n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.getUserBlogs();case 2:n=e.sent,t({type:"INITUSERBLOGS",userBlogs:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},inituser:function(e){return function(){var t=Object(w.a)(y.a.mark(function t(n){return y.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"LOGIN",data:e});case 1:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},getUsers:R,login:K,logout:P,notify:v,blogReducer:_,userReducer:Y,deleteBlog:I,likeBlog:T})(se),pe=(n(356),n(52)),fe=n(182),de=Object(pe.c)({blogs:_,notification:E,user:Y,userBlogs:Q,toggle:d,users:M,comments:re}),ge=Object(pe.d)(de,Object(pe.a)(fe.a));l.a.render(a.a.createElement(p.a,{store:ge},a.a.createElement(me,null)),document.getElementById("root"))}},[[193,2,1]]]);
//# sourceMappingURL=main.6dbb6fc2.chunk.js.map